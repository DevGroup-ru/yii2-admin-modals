{"version":3,"sources":["webpack:///webpack/bootstrap 133a642e194863e828ab","webpack:///./AdminModals.js"],"names":["AdminModals","init","bindModals","that","$","document","on","settings","modalActionSelector","$this","tagName","prop","toLowerCase","modalOpenOptions","url","method","data","attr","dataAttribute","modalOpen","options","$modal","combineUrl","adminModalPageUrl","find","click","modal","uniqueIdCounter","$frame","ready","loadInFrame","uniqueId","localStorage","removeItem","events","remove","off","frameDocument","contentWindow","adminModalsUniqueParamKey","uniqueIdPrefix","location","$form","adminModalFrameFormSelector","Object","keys","forEach","key","value","append","val","submit","extractFormButtons","resizeModal","magicParamValue","indexOf","magicParamKey","userSettings","window","AdminModalsSettings","Math","random","toString","addEventListener","e","receiveStorageMessage","console","log","newValue","parsedMessage","match","dontResizeWindow","maxWindowWidth","maxWindowHeight","$frameDocument","parentWidthLimit","windowWidthLimit","floor","width","parentHeightLimit","windowHeightLimit","height","frameWidth","frameHeight","newWidth","newHeight","css","frameWindow","f$","$buttons","$modalButtons","each","$modalButton","outerHTML","push","hide","empty"],"mappings":"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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 133a642e194863e828ab","class AdminModals {\n  constructor() {\n    this.init();\n\n    this.bindModals();\n  }\n\n  bindModals() {\n    const that = this;\n\n    $(document).on('click', this.settings.modalActionSelector, function () {\n      const $this = $(this);\n      const tagName = $this.prop('tagName').toLowerCase();\n      const modalOpenOptions = {\n        url: '#',\n        method: 'GET',\n        data: {}\n      };\n      switch (tagName) {\n        case 'a':\n          modalOpenOptions.url = $this.attr('href');\n          modalOpenOptions.data = $this.data(that.settings.dataAttribute) || {};\n          break;\n\n        case 'button':\n        case 'input':\n\n          break;\n        default:\n          break;\n      }\n      that.modalOpen(modalOpenOptions);\n      return false;\n    });\n  }\n\n  modalOpen(options) {\n    // create modal\n    const $modal = $(`\n<div class=\"modal fade AdminModal\" tabindex=\"-1\" role=\"dialog\" data-width=\"100%\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <a href=\"#\" data-dismiss=\"modal\" aria-hidden=\"true\" class=\"pull-right\">\n            <i class=\"fa fa-times fa-2x\"></i>\n        </a>\n        <a href=\"${this.combineUrl(options, 'tab')}\" target=\"_blank\" class=\"modal-title\">\n            ${options.url}\n        </a>\n      </div>\n     \n      <iframe src=\"${this.settings.adminModalPageUrl}\" frameborder=\"0\" class=\"modal-body modal-frame\"></iframe>\n    \n      <div class=\"modal-footer\">\n        \n      </div>\n    </div>\n  </div>\n</div>`);\n    $modal.find('.modal-title').click(function() {\n      $modal.modal('hide');\n      return true;\n    });\n    $modal.data('adminModalsUniqueId', ++this.uniqueIdCounter);\n\n    $modal\n      .on('shown.bs.modal', () => {\n        const $frame = $modal.find('.modal-frame');\n        $frame.ready(() => {\n          this.loadInFrame($frame, options, $modal);\n          return false;\n        });\n      })\n      .on('hidden.bs.modal', () => {\n        const uniqueId = $modal.data('adminModalsUniqueId');\n        // stop listening for storage\n        localStorage.removeItem(`adminModalsMessage:${uniqueId}`);\n        delete this.events[uniqueId];\n        // remove modal DOM element\n        $modal.remove();\n      });\n\n    $modal.modal('show');\n  }\n\n  loadInFrame($frame, options, $modal) {\n    $frame.off('ready');\n    const frameDocument = $frame[0].contentWindow.document;\n\n    options.data[this.settings.adminModalsUniqueParamKey] =\n      `${this.uniqueIdPrefix}_${$modal.data('admin-modals-unique-id')}`;\n\n    if (options.method === 'GET') {\n      frameDocument.location = this.combineUrl(options, 'modal');\n    } else {\n      // it's post\n      const $form = $frame.find(this.settings.adminModalFrameFormSelector);\n      $form.attr('action', this.combineUrl(options.url, 'modal'));\n      Object.keys(options.data).forEach((key) => {\n        const value = options.data[key];\n        $form.append(\n          $('<input type=\"hidden\">')\n            .attr('name', key)\n            .val(value)\n        );\n      });\n      $form.submit();\n    }\n    this.events[$modal.data('adminModalsUniqueId')] = () => {\n      AdminModals.extractFormButtons($frame, options, $modal);\n      AdminModals.resizeModal($frame, options, $modal);\n    };\n  }\n\n  static resizeModal($frame, options, $modal) {\n    if (options.dontResizeWindow === true) {\n      return;\n    }\n    const maxWindowWidth = options.maxWindowWidth || 95;\n    const maxWindowHeight = options.maxWindowHeight || 80;\n\n    const $frameDocument = $($frame[0].contentWindow.document);\n    const parentWidthLimit = (options.windowWidthLimit || Math.floor($(window).width() * maxWindowWidth / 100)) - 60;\n    const parentHeightLimit = (options.windowHeightLimit || Math.floor($(window).height() * maxWindowHeight / 100)) - 100;\n    const frameWidth = $frameDocument.width() + 20;\n    const frameHeight = $frameDocument.height();\n    const newWidth = frameWidth < parentWidthLimit ? frameWidth : parentWidthLimit;\n    const newHeight = frameHeight < parentHeightLimit ? frameHeight : parentHeightLimit;\n\n    $modal.find('.modal-dialog').css('display', 'table');\n    $frame.width(newWidth);\n    $frame.height(newHeight);\n  }\n\n  static extractFormButtons($frame, options, $modal) {\n    const frameWindow = $frame[0].contentWindow;\n    const f$ = frameWindow.$;\n    const $buttons = f$('.form-group,.form-actions,.admin-modals__form-buttons').find('input[type=submit],button[type=submit],.btn');\n    const $modalButtons = [];\n    $buttons.each(function() {\n      const $modalButton = $(this.outerHTML);\n      $modalButton.click(() => $(this).click());\n      $modalButtons.push($modalButton);\n      $(this).hide();\n    });\n\n    $modal.find('.modal-footer')\n      .empty()\n      .append(\n        $modalButtons\n      );\n  }\n\n  combineUrl(options, magicParamValue = 'modal') {\n    let url = options.url;\n    url += url.indexOf('?') >= 0 ? '&' : '?';\n    url += `${this.settings.magicParamKey}=${magicParamValue}`;\n\n    if (options.method === 'GET') {\n      // append data\n      Object.keys(options.data).forEach(key => {\n        const value = options.data[key];\n        url += `&${key}=${value}`;\n      });\n    }\n    return url;\n  }\n\n  init() {\n    const userSettings = window.AdminModalsSettings || {};\n    const settings = {\n      modalActionSelector: '.admin-modal-trigger',\n      dataAttribute: 'adminModals',\n      adminModalPageUrl: '/site/admin-modal',\n      adminModalFrameFormSelector: '.admin-modal__frame-form',\n      magicParamKey: '__admin_modals',\n      adminModalsUniqueParamKey: '__admin-modals__unique-id'\n    };\n    Object.keys(userSettings).forEach(key => {\n      settings[key] = userSettings[key];\n    });\n    this.settings = settings;\n\n    this.events = {};\n    this.uniqueIdPrefix = Math.random().toString();\n    this.uniqueIdCounter = 0;\n\n    window.addEventListener('storage', (e) => this.receiveStorageMessage(e));\n  }\n\n  receiveStorageMessage(e) {\n    console.log('message: ', e);\n    if (e.newValue === 'loaded' && e.key.indexOf('adminModalsMessage') === 0) {\n      const parsedMessage = e.key.match(/^adminModalsMessage:([\\d.]*)_([\\d]*)$/);\n      if (parsedMessage === null) {\n        // not a valid key\n        return;\n      }\n      if (parsedMessage[1] !== this.uniqueIdPrefix) {\n        // not our message\n        return;\n      }\n      localStorage.removeItem(e.key);\n      // const messageId = `${parsedMessage[1]}_${parsedMessage[2]}`;\n      this.events[parsedMessage[2]]();\n    }\n  }\n}\n\nwindow.AdminModals = new AdminModals();\n\n\n\n// WEBPACK FOOTER //\n// ./AdminModals.js"],"sourceRoot":""}