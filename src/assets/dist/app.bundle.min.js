!function(t){function e(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var a={};return e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,n){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=0)}([function(t,e,a){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),o=function(){function t(){n(this,t),this.init(),this.bindModals()}return i(t,[{key:"init",value:function(){var t=this,e=window.AdminModalsSettings||{},a={modalActionSelector:".admin-modal-trigger",dataAttribute:"adminModals",adminModalPageUrl:"/site/admin-modal",adminModalFrameFormSelector:".admin-modal__frame-form",magicParamKey:"__admin_modals",adminModalsUniqueParamKey:"__admin-modals__unique-id"};Object.keys(e).forEach(function(t){a[t]=e[t]}),this.settings=a,this.events={},this.uniqueIdPrefix=Math.random().toString(),this.uniqueIdCounter=0,window.addEventListener("storage",function(e){return t.receiveStorageMessage(e)})}},{key:"bindModals",value:function(){var t=this;$(document).on("click",this.settings.modalActionSelector,function(){var e=$(this),a=e.prop("tagName").toLowerCase(),n={url:"#",method:"GET",data:{}};switch(a){case"a":n.url=e.attr("href"),n.data=e.data(t.settings.dataAttribute)||{};break;case"button":case"input":}return t.modalOpen(n),!1})}},{key:"modalOpen",value:function(t){var e=this,a=$('\n<div class="modal fade AdminModal" tabindex="-1" role="dialog" style="display:none;" data-width="100%">   \n      <div class="modal-header">\n        <a href="#" data-dismiss="modal" aria-hidden="true" class="pull-right">\n            <i class="fa fa-times fa-2x"></i>\n        </a>\n        <a href="'+this.combineUrl(t,"tab")+'" target="_blank" class="modal-title">\n            '+t.url+'\n        </a>\n      </div>\n      <div class="modal-body">\n        <div class="tabs-container"></div>\n        <iframe src="'+this.settings.adminModalPageUrl+'" frameborder="0" class="modal-frame"></iframe>\n      </div>\n    \n      <div class="modal-footer">\n        \n      </div>  \n</div>');a.find(".modal-title").click(function(){return a.modal("hide"),!0}),a.data("adminModalsUniqueId",++this.uniqueIdCounter),a.on("shown.bs.modal",function(){var n=a.find(".modal-frame");n.ready(function(){return e.loadInFrame(n,t,a),!1})}).on("hidden.bs.modal",function(){var n=a.data("adminModalsUniqueId");localStorage.removeItem("adminModalsMessage:"+n),delete e.events[n],a.remove(),t.closeCallback&&t.closeCallback()}),a.modal("show")}},{key:"loadInFrame",value:function(e,a,n){e.off("ready");var i=e[0].contentWindow.document;if(a.data[this.settings.adminModalsUniqueParamKey]=this.uniqueIdPrefix+"_"+n.data("admin-modals-unique-id"),"GET"===a.method)i.location=this.combineUrl(a,"modal");else{var o=e.find(this.settings.adminModalFrameFormSelector);o.attr("action",this.combineUrl(a.url,"modal")),Object.keys(a.data).forEach(function(t){var e=a.data[t];o.append($('<input type="hidden">').attr("name",t).val(e))}),o.submit()}this.events[n.data("adminModalsUniqueId")]=function(){t.extractFormButtons(e,a,n),t.extractTabs(e),t.resizeModal(e,a,n)}}},{key:"combineUrl",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modal",a=t.url;return a+=a.indexOf("?")>=0?"&":"?",a+=this.settings.magicParamKey+"="+e,"GET"===t.method&&Object.keys(t.data).forEach(function(e){a+="&"+e+"="+t.data[e]}),a}},{key:"receiveStorageMessage",value:function(t){if(console.log("message: ",t),"loaded"===t.newValue&&0===t.key.indexOf("adminModalsMessage")){var e=t.key.match(/^adminModalsMessage:([\d.]*)_([\d]*)$/);if(null===e)return;if(e[1]!==this.uniqueIdPrefix)return;localStorage.removeItem(t.key),this.events[e[2]]()}}}],[{key:"resizeModal",value:function(t,e,a){if(e.dontResizeWindow!==!0){var n=e.maxWindowHeight||80,i=e.minWindowHeight||200,o=$(t[0].contentWindow.document),r=(e.windowHeightLimit||Math.floor($(window).height()*n/100))-120,d=Math.max(o.height(),i),s=d<r?d:r;a.find(".modal-dialog").css("display","table"),t.attr("style",t.attr("style")+"; height: "+s+"px !important")}}},{key:"extractFormButtons",value:function(t,e,a){var n=t[0].contentWindow,i=n.$,o=i(".form-actions,.admin-modals__form-buttons");if(o.length){var r=o.find("input[type=submit],button[type=submit],.btn"),d=[];r.each(function(){var t=this,e=$(this.outerHTML);e.click(function(){return $(t).click()}),d.push(e),$(this).hide()}),a.find(".modal-footer").empty().append(d)}}},{key:"extractTabs",value:function(t){var e=t[0].contentWindow,a=e.$,n=a(".nav-tabs"),i=$(".tabs-container").empty();if(n.length){var o=n[0].outerHTML,r=$(o);r.find("a").click(function(){var t=$(this).attr("href");n.find("a").filter(function(){return $(this).attr("href")===t}).click()}),i.append(r),n.hide(),a("h1").remove()}}}]),t}();window.AdminModals=new o}]);