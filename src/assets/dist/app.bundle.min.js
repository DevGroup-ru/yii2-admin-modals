!function(t){function n(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var a={};return n.m=t,n.c=a,n.i=function(t){return t},n.d=function(t,a,e){n.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:e})},n.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(a,"a",a),a},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="/",n(n.s=0)}([function(t,n,a){"use strict";function e(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function t(t,n){for(var a=0;a<n.length;a++){var e=n[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(n,a,e){return a&&t(n.prototype,a),e&&t(n,e),n}}(),o=function(){function t(){e(this,t),this.init(),this.bindModals()}return i(t,[{key:"bindModals",value:function(){var t=this;$(document).on("click",this.settings.modalActionSelector,function(){var n=$(this),a=n.prop("tagName").toLowerCase(),e={url:"#",method:"GET",data:{}};switch(a){case"a":e.url=n.attr("href"),e.data=n.data(t.settings.dataAttribute)||{};break;case"button":case"input":}return t.modalOpen(e),!1})}},{key:"modalOpen",value:function(t){var n=this,a=$('\n<div class="modal fade AdminModal" tabindex="-1" role="dialog" data-width="100%">\n  <div class="modal-dialog" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <a href="#" data-dismiss="modal" aria-hidden="true" class="pull-right">\n            <i class="fa fa-times fa-2x"></i>\n        </a>\n        <a href="'+this.combineUrl(t,"tab")+'" target="_blank" class="modal-title">\n            '+t.url+'\n        </a>\n      </div>\n     \n      <iframe src="'+this.settings.adminModalPageUrl+'" frameborder="0" class="modal-body modal-frame"></iframe>\n    \n      <div class="modal-footer">\n        \n      </div>\n    </div>\n  </div>\n</div>');a.find(".modal-title").click(function(){return a.modal("hide"),!0}),a.data("adminModalsUniqueId",++this.uniqueIdCounter),a.on("shown.bs.modal",function(){var e=a.find(".modal-frame");e.ready(function(){return n.loadInFrame(e,t,a),!1})}),a.modal("show")}},{key:"loadInFrame",value:function(t,n,a){var e=this;t.off("ready");var i=t[0].contentWindow.document;if(n.data[this.settings.adminModalsUniqueParamKey]=this.uniqueIdPrefix+"_"+a.data("admin-modals-unique-id"),"GET"===n.method)i.location=this.combineUrl(n,"modal");else{var o=t.find(this.settings.adminModalFrameFormSelector);o.attr("action",this.combineUrl(n.url,"modal")),Object.keys(n.data).forEach(function(t){var a=n.data[t];o.append($('<input type="hidden">').attr("name",t).val(a))}),o.submit()}this.events[a.data("adminModalsUniqueId")]=function(){e.extractFormButtons(t,n,a)}}},{key:"extractFormButtons",value:function(t,n,a){console.log("start extract buttons");var e=t[0].contentWindow,i=e.$,o=i(".form-group,.form-actions,.admin-modals__form-buttons").find("input[type=submit],button[type=submit]"),r=[];o.each(function(){var t=this,n=$(this.outerHTML);n.click(function(){return $(t).click()}),r.push(n),$(this).hide()}),a.find(".modal-footer").append($('<div class="btn-group"></div>').append(r))}},{key:"combineUrl",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"modal",a=t.url;return a+=a.indexOf("?")>=0?"&":"?",a+=this.settings.magicParamKey+"="+n,"GET"===t.method&&Object.keys(t.data).forEach(function(n){a+="&"+n+"="+t.data[n]}),a}},{key:"init",value:function(){var t=this,n=window.AdminModalsSettings||{},a={modalActionSelector:".admin-modal-trigger",dataAttribute:"adminModals",adminModalPageUrl:"/site/admin-modal",adminModalFrameFormSelector:".admin-modal__frame-form",magicParamKey:"__admin_modals",adminModalsUniqueParamKey:"__admin-modals__unique-id"};Object.keys(n).forEach(function(t){a[t]=n[t]}),this.settings=a,this.actionMatchers=window.AdminModalsActionMatchers||[],this.events={},this.uniqueIdPrefix=Math.random().toString(),this.uniqueIdCounter=0,window.addEventListener("storage",function(n){return t.receiveStorageMessage(n)})}},{key:"receiveStorageMessage",value:function(t){if(console.log("message: ",t),"loaded"===t.newValue&&0===t.key.indexOf("adminModalsMessage")){var n=t.key.match(/^adminModalsMessage:([\d.]*)_([\d]*)$/);if(null===n)return;if(n[1]!==this.uniqueIdPrefix)return;localStorage.removeItem(t.key),this.events[n[2]]()}}}]),t}();window.AdminModals=new o}]);